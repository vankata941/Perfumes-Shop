<!doctype html>
<html lang="en" data-bs-theme="auto"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
>
<head th:replace="~{commons/head::head}"></head>

<body>

<header th:replace="~{commons/header::header}"></header>

<div class="container mt-5">
    <h1 class="mb-4">Shopping Cart</h1>
    <div class="row">
        <div class="col-md-8">
            <div class="card mb-3">
                <div class="card-header">
                    <h4>Cart Items</h4>
                </div>
                <ul class="list-group list-group-flush">
                    <li
                            class="list-group-item d-flex justify-content-between align-items-center"
                            th:each="cartItem : ${cartItems}"
                    >
                        <div class="d-flex align-items-center">
                            <img th:src="'data:image/jpeg;base64,' + ${cartItem.image}"
                                 th:alt="${cartItem.name}"
                                 class="img-thumbnail me-3"
                                 style="width: 100px; height: 100px;"
                            />
                            <div>
                                <h5 class="mb-1" th:text="${cartItem.brand}">Product Brand</h5>
                                <p class="mb-1" th:text="${cartItem.name}">Product Name</p>
                                <p class="mb-1"><span th:text="${cartItem.packaging}">Product Packaging</span> <span th:text="#{product_packaging}">ml.</span></p>
                                <div class="d-flex align-items-center">
                                    <form
                                            th:action="@{/cart/cart-item/{id}(id = *{cartItem.id})}"
                                            th:method="POST"
                                            onchange="this.form.submit()"
                                    >
                                    <label class="mb-2" for="quantitySelector">Quantity:</label>
                                    <input
                                            id="quantitySelector"
                                            th:value="${cartItem.quantity}"
                                            type="number"
                                            class="form-control mr-2"
                                            style="width: 70px;"
                                            min="1"
                                            required
                                    >
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex flex-column align-items-end">
                            <p class="mb-2">Price:</p>
                            <div class="price" data-id="price-${cartItem.id}" th:text="${cartItem.price}">0.0</div>
                            <input type="hidden" class="priceInBGN" data-id="price-${cartItem.id}" th:value="${cartItem.price}">
                        <form
                                class="mt-3"
                                th:action="@{/cart/delete/cart-item/{id}(id = *{cartItem.id})}"
                                th:method="DELETE"
                        >
                            <button class="btn btn-danger btn-sm">Remove</button>
                        </form>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h4>Order Summary</h4>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <span>Subtotal</span>
                        <span
                                class="price"
                                data-id="price-subtotal"
                                th:text="${subtotal}">
                            0.0
                        </span>
                        <input type="hidden" class="priceInBGN" data-id="price-subtotal" th:value="${subtotal}">
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>Shipping</span>
                        <span
                                class="price"
                                data-id="price-shipping"
                                th:text="${shipping}"
                        >
                            0.0
                        </span>
                        <input type="hidden" class="priceInBGN" data-id="price-shipping" th:value="${shipping}">
                    </div>
                    <hr>
                    <div class="d-flex justify-content-between">
                        <strong>Total</strong>
                        <strong
                                class="price"
                                data-id="price-total"
                                th:text="${totalPrice}"
                        >
                            0.0
                        </strong>
                        <input type="hidden" class="priceInBGN" data-id="price-total" th:value="${totalPrice}">
                    </div>
                    <button class="btn btn-primary btn-block mt-3">Proceed to Checkout</button>
                </div>
            </div>
        </div>
    </div>
</div>
<footer th:replace="~{commons/footer::footer}"></footer>
</body>
</html>